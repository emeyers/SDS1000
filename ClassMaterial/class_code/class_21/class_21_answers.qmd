---
title: "Class 21 notes and code"
format: pdf
editor: source
editor_options: 
  chunk_output_type: console
---





# Part 1: Warm-up - Parametric hypothesis test for a proportion

Background:

Most people are right handed, right eye dominant, etc.  Biologists have
suggested that human embryos tend to turn their heads to the right as
well.German bio-psychologist Onur Güntürkün conjectured that this tendency
manifests itself in other ways, so he studies which ways people turn their heads
when they kiss.

In a study of 124 couples kissing, 80 of the couples turned their heads to the
right.  Is there evidence that more than half of all couples turn their heads to
the right when they kiss? Let's run a parametric hypothesis test for a
proportion to find out!




$\\$


Step 1: State the null and alternative hypotheses

In words: 

- Null hypothesis: All couples are equally likely to turn their heads to the right or left when they kiss (i.e. 50% turn right).

- Alternative hypothesis: More than half of all couples turn their heads to the right when they kiss. 


In symbols:

$H_0: \pi = 0.50$

$H_A: \pi > 0.50$



```{r hypothesis_test_proportion}



# Step 2: Calculate the z-statistic

# first assess that np and n(1-p) are both at least 10
0.5 * 124   # 62 is greater than 10 so we can use a normal distribution for the null distribution


# calculate the z-statistic
p_hat <- 80 / 124
pi_0 <- 0.5

SE <- sqrt((pi_0 * (1 - pi_0)) / 1000)

z_stat <- (p_hat - pi_0) / SE




# Step 3: Visualize the null distribution

x_values_null <- seq(-10, 10, length.out = 1000)
density_values_null <- dnorm(x_values_null, mean = 0, sd = 1)

plot(x_values_null, density_values_null, type = "l",
     main = "Null Distribution of Z-statistic",
     xlab = "Z-score",
     ylab = "Density",
     col = "blue")

abline(v = z_stat, col = "red", lwd = 2)



# Step 4: Calculate the p-value

p_value <- pnorm(z_stat, 0, 1, lower.tail = FALSE)
p_value



```



Step 5: Make a decision

Since our p-value is very small, we reject the null hypothesis and conclude that
there is evidence to suggest that more than half of all couples turn their heads
to the right when they kiss.




$\\$




Note: we could also get a p-value without converting to a z-statistic (and if
you take additional statistics/probability courses, you will learn you could
also use a binomial distribution as the null distribution too).

```{r hypothesis_test_proportion_alternative}

# Alternative way to calculate the p-value directly
p_value_alternative <- pnorm(p_hat, 0.5, SE, lower.tail = FALSE)

p_value_alternative

```



  




$\\$






# Part 2: Calculating quantities from a t-distribution


Suppose we have a sample size is n = 16, please calculate the following values: 

1. The 2.5th and 97.5th percentiles from a t-distribution

2. The probability that a t-statistic is more than 1.5

3. Also, calculate these same values for the standard normal distribution


```{r t_distribution_calculations, message = FALSE}


# Calculate the degrees of freedom

df <- 16 - 1  




# 1. Calculate the 2.5th and 97.5th percentiles from a t-distribution

t_lower <- qt(0.025, df)
t_upper <- qt(0.975, df)
c(t_lower, t_upper)



# We can also use the mosaic::ct() function to do this calculation

mosaic::ct( c(0.025, 0.975), df = df)

#mosaic::xct( c(0.025, 0.975), df = df)  # visualize the quantiles





# 2. Calculate the probability that a t-statistic is more than 1.5

prob_t <- pt(1.5, df, lower.tail = FALSE)
prob_t


# visaulize this probability using mosaic package
#mosaic::xpt(1.5, df, lower.tail = FALSE)




# 3. Calculate the same values for the standard normal distribution

z_lower <- qnorm(0.025, 0, 1)
z_upper <- qnorm(0.975, 0, 1)
c(z_lower, z_upper)


# mosaic::cnorm(.95, 0, 1)


prob_z <- pnorm(1.5, 0, 1, lower.tail = FALSE)
prob_z



```





$\\$





# Part 3: Parametric confidence interval for a single mean



A study by Loyd et al (2013) in Biological Conservation, used KittyCams to
record all activity of n = 55 domestic cats that hunt outdoors.

The video footage showed that the mean number of kills per week for these cats
was 2.4 with a standard deviation of 1.51.

Find and interpret a 99% confidence interval for the mean number of kills per
week by US household cats that hunt outdoors.


$$CI ~ = ~ \bar{x} ~ \pm ~ t^* \cdot \frac{s}{\sqrt{n}}$$



```{r confidence_interval_mean}

# Given data
n <- 55
x_bar <- 2.4
s <- 1.51


# Degrees of freedom
df <- n - 1



# Calculate the standard error (SE)
SE <- s / sqrt(n)
SE



# Find the critical t-value for the desired confidence level
t_critical <- qt(.995, df)
t_critical

t_critical2 <- mosaic::ct(.99, df, side = "upper")
t_critical2



# Calculate the margin of error (ME)
ME <- t_critical * SE
ME



# Construct the confidence interval
lower_bound <- x_bar - ME
upper_bound <- x_bar + ME
c(lower_bound, upper_bound)


```







$\\$







# Part 4: Parametric hypothesis test for a single mean


In the mid-1990s a Nabisco marking campaign claimed that there were at least
1000 chips in every bag of Chips Ahoy! cookies.

A group of Air Force cadets tested this claim by dissolving the cookies from 42
bags in water and counting the number of chips.

They found the average number of chips per bag was 1261.6, with a standard
deviation of 117.6 chips

Test whether the average (mean) number of chips per bag is greater than 1000.  

Do the results confirm Nabisco’s claim?  



$\\$

Step 1: State the null and alternative hypotheses


In words: 

- Null hypothesis: The average number of chips per bag is 1000.
- Alternative hypothesis: The average number of chips per bag is greater than 1000.


In symbols:  

- $H_0: \mu = 1000$
- $H_A: \mu > 1000$



```{r hypothesis_test_mean}



# Step 2: Calculate the t-statistic

n <- 42
x_bar <- 1261.6
s <- 117.6
mu_0 <- 1000

SE <- s / sqrt(n)
t_stat <- (x_bar - mu_0) / SE
t_stat



# Step 3: Visualize the null distribution

df <- n - 1

x_values_null <- seq(-5, 5, length.out = 1000)
density_values_null <- dt(x_values_null, df)

plot(x_values_null, density_values_null, type = "l",
     main = "Null Distribution of T-statistic",
     xlab = "T-score",
     ylab = "Density",
     col = "blue")

abline(v = t_stat, col = "red", lwd = 2)



# Step 4: Calculate the p-value
p_value <- pt(t_stat, df, lower.tail = FALSE)
p_value


```



Step 5: Make a decision

Since our p-value is very small, we reject the null hypothesis and conclude that
there is evidence to suggest that the average number of chips per bag is greater
than 100


Does this confirm Nabisco's claim? 


No, the results suggest that the average number of chips per bag is
significantly greater than 1000. However, Nabisco's claim was that there were at
least 1000 chips in every bag, which is a different assertion. The test only
indicates that the average exceeds 1000, not that every individual bag meets
this criterion!








