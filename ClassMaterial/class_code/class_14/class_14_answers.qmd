---
title: "Class 14 notes and code"
format: pdf
editor: source
editor_options: 
  chunk_output_type: console
---




## Part 1: Lie detector hypothesis test

A study by Hollien, Harnsberger, Martin and Hollien (2010) tried to assess the 
accuracy of lie detection software. 

A sample of 48 participants were gather and attached to a lie detection device. 
They were asked to read deceptive (lying) material out loud. 

The lie detector correctly reported that 31 out of the 48 participants were lying. 

Let's run a hypothesis test to see if the results provide evidence that lie 
detectors are more than 60% accurate? 





$\\$





### Step 1: State the null and alternative hypotheses 


Words:  
 * Null hypothesis: The lie detector is 60% accurate  
 * Alternative hypothesis: The lie detector is more than 60% accurate  
 
Symbols:  
 * $H_0: \pi = 0.6$  
 * $H_A: \pi > 0.6$  



$\\$




### Step 2: Calculate the observed statistic



```{r lie_detector_stat}


# step 2: compute observed statistic

(obs_stat <- 31/48)



```




$\\$





### Step 3: create the null distribution



```{r lie_detector_null_distribution}


library(SDS1000)


null_dist <- do_it(10000) * {
  
  rflip(48, .6)/48
  
}



# plot the null distribution
hist(null_dist, breaks = 100, 
     main = "Null distribution",
     xlab = "Proportion passing lie-detector test")

abline(v = obs_stat, col = "red")


```




$\\$




### Step 4: calculate the p-value


```{r lie_detector_p_value}

pnull(obs_stat, null_dist, lower.tail = FALSE)

```





$\\$





### 5. Step 5: Make decision


Since the p-value is greater than the typical cutoff of 0.05, we fail to 
reject the null hypothesis and we could call the result "not statistically
significant". We will discuss what this means in more detail (and whether we
should even use the term "statistically significant") in future classes.




$\\$




**Question**: What would have happened if we had tested whether lie detector 
tests get it correct more than 50% of the time? 

Try it!





$\\$




## Part 2: Two-sided hypothesis tests

Let's say we want to test whether the lie detector is different from 60% accurate.


$\\$


### Step 1: State the null and alternative hypotheses

Words:  

* Null hypothesis: The lie detector is 60% accurate
* Alternative hypothesis: The lie detector is different from 60% accurate
 
Symbols:  

* $H_0: \pi = 0.6$  
* $H_A: \pi \neq 0.6$   
   
   
   

$\\$   
   


### Step 2: Calculate the observed statistic


```{r lie_detector_stat_2sided}

(obs_stat <- 31/48)

```





$\\$






### Step 3: create the null distribution


```{r lie_detector_null_distribution_2sided}

library(SDS1000)

null_dist <- do_it(10000) * {
  
  rflip(48, .6)/48
  
}

# plot the null distribution
hist(null_dist, breaks = 100,
     main = "Null distribution",
     xlab = "Proportion passing lie-detector test")

abline(v = obs_stat, col = "red")

```




$\\$





### Step 4: calculate the p-value


```{r lie_detector_p_value_2sided}

stat_param_margin <- abs(obs_stat - 0.6)

pval_left <- pnull(0.6 - stat_param_margin, null_dist, lower.tail = TRUE)
pval_right <- pnull(0.6 + stat_param_margin, null_dist, lower.tail = FALSE)

p_value <- pval_left + pval_right

p_value


```




$\\$




### 5. Step 5: Make decision


Since the p-value is greater than the typical cutoff of 0.05, we fail to reject
the null hypothesis and we could call the result "not statistically
significant".

     



$\\$






## Part 3: Hypothesis tests for two means


A randomized controlled trial by Lyle et al (1987) investigated whether calcium
lowered blood pressure.

 - A treatment group of 10 men received a calcium supplement for 12 weeks.  
 - A control group of 11 men received a placebo during the same period.  

The blood pressure of these men was taken before and after the 12 weeks of the study.

Let's run a hypothesis test to see if there was a larger decrease in blood
pressure for participants that received calcium compared to those that received
a placebo.




$\\$



### Step 1: State the null and alternative hypotheses

Words:

* Null hypothesis: The mean decrease in blood pressure is the same for both groups  
* Alternative hypothesis: The mean decrease in blood pressure is greater for the treatment group  
 
Symbols:

* $H_0: \mu_{treat} = \mu_{control}$  
* $H_A: \mu_{treat} > \mu_{control}$  
 




$\\$






### Step 2: Calculate the observed statistic


```{r calcium_obs_stat}


# the data from the calcium study
treat <- c(7, -4, 18, 17, -3, -5,  1, 10, 11, -2)
control <- c(-1,  12,  -1,  -3,   3,  -5,   5,   2, -11,  -1,  -3)



# observed statistic
obs_stat <- mean(treat) - mean(control)

obs_stat


```






$\\$






### Step 3: create the null distribution


```{r calcium_null_distribution}


#  Combine data from both groups
combined_data <- c(treat, control)


null_dist <-  do_it(10000) * {

       # shuffle data
        shuff_data <- shuffle(combined_data)

        # create fake treatment and control groups
        shuff_treat   <-  shuff_data[1:10]
        shuff_control  <-  shuff_data[11:21]

        # aclculate the shuffled statistic of interest
        mean(shuff_treat) - mean(shuff_control)

}


# plot the null distribution
hist(null_dist, breaks = 200,
     main = "Null distribution",
     xlab = "Difference in mean decrease in blood pressure")


# add a red vertical line at the observed statistic
abline(v = obs_stat, col = "red")


```







$\\$







### Step 4: calculate the p-value


```{r calcium_p_value}

pnull(obs_stat, null_dist, lower.tail = FALSE)

```





$\\$






### 5. Step 5: Make decision


Since the p-value is (just barely) greater than the typical cutoff of 0.05. So,
if we were to use the strict rule of only rejecting the null hypothesis if the
significance level is less than 0.05 we would fail to reject the null hypothesis
here.


     







