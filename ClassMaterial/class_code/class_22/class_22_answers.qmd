---
title: "Class 22 notes and code"
format: pdf
editor: source
editor_options: 
  chunk_output_type: console
---






# Part 1: Parametric confidence interval for a single mean



A study by Nierenberg et al (1989) investigated the relationship between dietary
factors, and plasma concentrations of carotenoids.

Let’s use the data they collected to create a 98% confidence interval for the
number of grams fiber US adults get in a day.



$$CI ~ = ~ \bar{x} ~ \pm ~ t^* \cdot \frac{s}{\sqrt{n}}$$



```{r confidence_interval_mean}

# Given data
nutrition_df <- read.csv("NutritionStudy.csv")
fiber <- nutrition_df$Fiber


# Get basic descriptive statistics
n <- length(fiber)          
x_bar <- mean(fiber)       
s <- sd(fiber)             


# Degrees of freedom
df <- n - 1


# Calculate the standard error (SE)
SE <- s / sqrt(n)
SE



# Find the critical t-value for the desired confidence level
t_critical <- qt(.99, df)
t_critical

t_critical2 <- mosaic::ct(.98, df, side = "upper")
t_critical2



# Calculate the margin of error (ME)
ME <- t_critical * SE
ME



# Construct the confidence interval
lower_bound <- x_bar - ME
upper_bound <- x_bar + ME
c(lower_bound, upper_bound)


```




$\\$





# Part 2: Parametric hypothesis test for a single mean


In the mid-1990s a Nabisco marking campaign claimed that there were at least
1000 chips in every bag of Chips Ahoy! cookies.

A group of Air Force cadets tested this claim by dissolving the cookies from 42
bags in water and counting the number of chips.

They found the average number of chips per bag was 1261.6, with a standard
deviation of 117.6 chips

Test whether the average (mean) number of chips per bag is greater than 1000.  

Do the results confirm Nabisco’s claim?  



$\\$

Step 1: State the null and alternative hypotheses


In words: 

- Null hypothesis: The average number of chips per bag is 1000.
- Alternative hypothesis: The average number of chips per bag is greater than 1000.


In symbols:  

- $H_0: \mu = 1000$
- $H_A: \mu > 1000$



```{r hypothesis_test_mean}



# Step 2: Calculate the t-statistic

n <- 42
x_bar <- 1261.6
s <- 117.6
mu_0 <- 1000

SE <- s / sqrt(n)
t_stat <- (x_bar - mu_0) / SE
t_stat



# Step 3: Visualize the null distribution

df <- n - 1

x_values_null <- seq(-5, 5, length.out = 1000)
density_values_null <- dt(x_values_null, df)

plot(x_values_null, density_values_null, type = "l",
     main = "Null Distribution of T-statistic",
     xlab = "T-score",
     ylab = "Density",
     col = "blue")

abline(v = t_stat, col = "red", lwd = 2)



# Step 4: Calculate the p-value
p_value <- pt(t_stat, df, lower.tail = FALSE)
p_value


```



Step 5: Make a decision

Since our p-value is very small, we reject the null hypothesis and conclude that
there is evidence to suggest that the average number of chips per bag is greater
than 100


Does this confirm Nabisco's claim? 


No, the results suggest that the average number of chips per bag is
significantly greater than 1000. However, Nabisco's claim was that there were at
least 1000 chips in every bag, which is a different assertion. The test only
indicates that the average exceeds 1000, not that every individual bag meets
this criterion!



$\\$




# Part 3: Confidence interval for the difference of two means

A study by Nierenberg et al (1989) investigated the relationship between dietary
factors, and plasma concentrations of carotenoids.

Let’s continue to use the data they collected, but this time let's create a 95%
confidence interval for the differences in the number of grams of fiber eaten in
a day between males and females.


$$CI ~ = ~ (\bar{x}_1 - \bar{x}_2) ~ \pm ~ t^* \cdot \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}$$

```{r confidence_interval_difference_means}

# Given data
nutrition_df <- read.csv("NutritionStudy.csv")

fiber_males  <- subset(nutrition_df, Sex == "Male")$Fiber
fiber_females <- subset(nutrition_df, Sex == "Female")$Fiber


# Get basic descriptive statistics for males
n1 <- length(fiber_males)          
x_bar1 <- mean(fiber_males)      
var1 <- var(fiber_males)            

# Get basic descriptive statistics for females
n2 <- length(fiber_females)            
x_bar2 <- mean(fiber_females)         
var2 <- var(fiber_females)            


# Degrees of freedom (using the smaller of n1-1 and n2-1)
df <- min(n1 - 1, n2 - 1)

# Calculate the standard error (SE)
SE_diff <- sqrt((var1 / n1) + (var2 / n2))
SE_diff

# Find the critical t-value for the desired confidence level
t_critical <- qt(.975, df)
t_critical

# Calculate the margin of error (ME)
ME_diff <- t_critical * SE_diff
ME_diff


# Construct the confidence interval
lower_bound_diff <- (x_bar1 - x_bar2) - ME_diff
upper_bound_diff <- (x_bar1 - x_bar2) + ME_diff
c(lower_bound_diff, upper_bound_diff)

```


Question: Does it seem that there is a difference in the amount of fiber males
and females eat in a day?


Answer: The confidence interval does includes zero, so we do not have strong
evidence to suggest a difference in the amount of fiber consumed by males and
females in a day.



$\\$




# Part 4: Hypothesis test for the difference of two means


A study randomly sampled 2295 American men 
- 2027 men were right-handed, 268 men were left-handed
- Right-handers earned \$13.10/hr, left-handers earned \$13.40/hr
- The standard deviation for both groups was \$7.90

Test the hypothesis that there is a difference in earnings between right and
left-handed men.

```{r hypothesis_test_difference_means}

# Given data
n1 <- 2027
x_bar1 <- 13.10
s1 <- 7.90

n2 <- 268
x_bar2 <- 13.40
s2 <- 7.90



# Step 2: Calculate the t-statistic
SE_diff <- sqrt((s1^2 / n1) + (s2^2/ n2))

t_stat <- (x_bar1 - x_bar2) / SE_diff
t_stat



# Step 3: Visualize the null distribution
df <- min(n1 - 1, n2 - 1)

x_values_null <- seq(-5, 5, length.out = 1000)
density_values_null <- dt(x_values_null, df)

plot(x_values_null, density_values_null, type = "l",
     main = "Null Distribution of T-statistic",
     xlab = "T-score",
     ylab = "Density",
     col = "blue")

abline(v = t_stat, col = "red", lwd = 2)
abline(v = -1 * t_stat, col = "red", lwd = 2)



# Step 4: Calculate the p-value
p_value <- 2 * pt(-abs(t_stat), df)
p_value


```


Step 5: Make a decision


Since our p-value is large, we fail to reject the null hypothesis and conclude
that there is not enough evidence to suggest a difference in earnings between
right and left-handed men.



$\\$




# Part 5: Paired samples t-test


A professor was interested in assessing if students scored higher on average on
the second exam based on a sample of data from 10 students. 

Let's run a paired samples t-test to see if there is a significant difference in
exam scores between the first and second exams.

Step 1:

$H_0: \mu_d = 0$
$H_A: \mu_d > 0$




```{r paired_samples_t_test}

# Given data
exam1 <- c(72, 95, 56, 87, 80, 98, 74, 85, 77, 62)
exam2 <- c(78, 96, 72, 89, 80, 95, 86, 87, 82, 72)


# Calculate the differences
exam_diff  <- exam2 - exam1


# Step 2: Calculate the t-statistic
SE_diff <- sd(exam_diff)/sqrt(10) 
t_stat <- mean(exam_diff)/SE_diff  


# Step 4: Calculate the p-value
p_val <- pt(t_stat, df = 9, lower.tail = FALSE)  
p_val

```



Step 5: Make a decision

Since our p-value is smaller than 0.05, we reject the null hypothesis and
conclude that there is evidence to suggest that students score higher on average
on the second exam compared to the first exam.


Try this at home: Run an independent samples t-test that assumes the two samples
of exam scores are come from different randomly selected students. Do you come
to the same conclusion if you ran this hypothesis test? 



$\\$



