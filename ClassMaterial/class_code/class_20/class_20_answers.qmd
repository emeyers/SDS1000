---
title: "Class 20 notes and code"
format: pdf
editor: source
editor_options: 
  chunk_output_type: console
---





# Part 1: Inference using the normal distribution

We can use the normal distribution to perform inference about population parameters
based on sample statistics.



$\\$




## Example: Hypothesis test for a single proportion with a known SE


Do goalies guess the direction of a penalty shot less than 50% of the time? 


From 1982 to 1994 there were 128 penalty shots in the World Cup.  
Goal keepers correctly guessed the direction 41% of the time With SE* = 0.043                             



### Step 1: 


$H_0: \pi$ = .5
$H_A: \pi$ < .5



$\\$




### Step 2-5: 

2. Calculate the z-statistic using the formula: $$z = \frac{\hat{p} - \pi_0}{SE^*} $$

3. Visualize the null distribution using `dnorm()` function.

4. Calculate the p-value using the standard normal distribution (`pnorm()` function)

5. Make a decision based on the p-value and significance level (e.g., $\alpha$ = 0.05)



```{r}


# step 2: calculate the z-statistic
z_stat <- (.41 - .5)/.043 



# step 3: visualize the null distribution

x_values_null <- seq(-4, 4, length.out = 1000)
density_values_null <- dnorm(x_values_null, mean = 0, sd = 1)


plot(x_values_null, density_values_null, type = "l",
     main = "Null Distribution of Z-statistic",
     xlab = "Z-score", 
     ylab = "Density", 
     col = "blue")
abline(v = z_stat, col = "red", lwd = 2)



# step 4: use the pnorm function to get the p-value
pnorm(z_stat, 0, 1)


```


5. Make a decision!



Since our p-value is less than 0.05 we would reject the null hypothesis and
conclude that goalies guess the direction of a penalty shot less than 50% of the
time.



$\\$



Can you also create a 99% confidence interval for the proportion of correct
guesses by goalies during penalty shots using the known SE?

```{r ci_proportion}

# Given data
p_hat <- 0.41
SE_star <- 0.043


z_critical <- qnorm(0.995)  # for 99% CI
#z_critical2 <- mosaic::cnorm(0.99, side = "upper")  # same as above



# Calculate the margin of error
margin_of_error <- z_critical * SE_star




# Calculate the confidence interval
ci_lower <- p_hat - margin_of_error
ci_upper <- p_hat + margin_of_error
c(ci_lower, ci_upper)


```



$\\$




# Part 2: Sampling distribution for proportions


In the United States, 65.1% of all houses are owned. Suppose that we sampled n = 50
houses at random from the population of all houses in the United States.

Can you visualize what the sampling distribution of the sample proportion would look like
if we took many samples of size n = 50?

What if we sampled n = 200 houses instead?

```{r sampling_dist_proportion, fig.width=7, fig.height=4}


n <- 50
pi_houses <- 0.651


# Calculate the standard error
SE_proportion <- sqrt((pi_houses * (1 - pi_houses)) / n)


# Create a sequence of x values
x_values <- seq(0, 1, length.out = 1000)

# Calculate the density values for the sampling distribution
density_values <- dnorm(x_values, mean = pi_houses, sd = SE_proportion)


# Plot the sampling distribution
plot(x_values, density_values, type = "l",
     main = paste("Sampling Distribution of Sample Proportion"),
     xlab = "Sample Proportion",
     ylab = "Density",
     col = "blue",
     ylim = c(0, 12))




# Repeat for n = 200

n2 <- 200

SE_proportion2 <- sqrt((pi_houses * (1 - pi_houses)) /n2)

density_values2 <- dnorm(x_values, mean = pi_houses, sd = SE_proportion2)

lines(x_values, density_values2, col = "red")

legend("topright", legend = c("n = 50", "n = 200"), col = c("blue", "red"), lty = 1)


```





$\\$




# Part 3: Parametric confidence intervals a proportion

A survey asked 2625 people whether they agreed with the statement “There is only
one true love for each person”. 1812 of the respondents disagreed. Compute a 90%
confidence interval for the proportion who disagreed.

Hint: this formula could help: CI = $\hat{p} \pm \cdot \sqrt{\frac{\hat{p}(1 - \hat{p})}{n}}$


```{r ci_proportion_parametric}

# Given data
n <- 2625
x <- 1812
p_hat <- x / n


# calculate the critical value
z_critical <- qnorm(0.95)  # for 90% CI
#z_critical2 <- mosaic::cnorm(0.90, side = "upper")  # same as above


# Calculate the standard error
SE_hat <- sqrt((p_hat * (1 - p_hat)) / n)


# Calculate the margin of error
margin_of_error <- z_critical * SE_hat


# Calculate the confidence interval
ci_lower <- p_hat - margin_of_error
ci_upper <- p_hat + margin_of_error
c(ci_lower, ci_upper)

```



Bonus: Create a confidence interval using the bootstrap for the same data and compare the results!





$\\$





# Part 4: Parametric hypothesis test for a proportion

A telephone survey of 1000 randomly selected US adults found that 31% of them
say they believe in ghosts. Does this provided evidence that more than 1 in 4 US
adults believe in ghosts?

Please run a hypothesis test at the $\alpha$ = 0.05 significance level to assess
whether more than 25% of US adults believe in ghosts.



$\\$


Step 1: state the null and alternative hypotheses

In words:

Null hypothesis: The proportion of US adults who believe in ghosts is equal to 25%.

Alternative hypothesis: The proportion of US adults who believe in ghosts is greater than 25%.


In symbols:

$H_0: \pi = 0.25$
$H_A: \pi > 0.25$



```{r hypothesis_test_proportion}


# Step 2: Calculate the z-statistic

p_hat <- 0.31
pi_0 <- 0.25

SE <- sqrt((pi_0 * (1 - pi_0)) / 1000)

z_stat <- (p_hat - pi_0) / SE




# Step 3: Visualize the null distribution

x_values_null <- seq(-4, 4, length.out = 1000)
density_values_null <- dnorm(x_values_null, mean = 0, sd = 1)

plot(x_values_null, density_values_null, type = "l",
     main = "Null Distribution of Z-statistic",
     xlab = "Z-score",
     ylab = "Density",
     col = "blue")

abline(v = z_stat, col = "red", lwd = 2)



# Step 4: Calculate the p-value

p_value <- pnorm(z_stat, 0, 1, lower.tail = FALSE)
p_value



```



Step 5: Make a decision


Since our p-value is less than 0.05, we reject the null hypothesis and conclude
that there is sufficient evidence to suggest that more than 25% of US adults
believe in ghosts.




$\\$













