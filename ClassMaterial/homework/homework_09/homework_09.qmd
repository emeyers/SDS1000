---
title: "Homework 9"
format: pdf
editor: source
editor_options: 
  chunk_output_type: console
---




$\\$





The purpose of this homework is to practice running parametric hypothesis tests
and computing parametric confidence intervals for one and two means. Please
submit a compiled pdf with your answers to the exercises to Gradescope 
*by 11pm on Sunday November 16th*, making sure to mark all correct pages per 
question to avoid points being taken off your score.

Functions you might find useful are `pt()` and `qt()` along with the list of
functions found on Canvas. For full credit on problems involving R, be sure to
label all your figures and to "show your work" by making sure all values that
are answers to questions are printed/visible in your Quarto pdf.

As always, if you need help with any of the homework assignments, please attend
the TA office hours which are listed on Canvas and/or ask questions on Ed
Discussions forum. Also, if you have completed the homework, please help others
out by answering questions on Ed Discussions. Finally, attending the practice
sessions and reviewing the class slides will be helpful if you run into
difficulties.






<!-- This R chunk sets some parameters that will be used in the rest of the document. Please ignore it and do not modify it. -->

```{r message=FALSE, warning=FALSE, tidy=TRUE, echo=FALSE}
    
  library(SDS1000)
  library(knitr)
  options(scipen=999)
  set.seed(100)
  
```






$\\$






## Part 1: Parametric inference for a single mean


In the first set of exercises you will explore questions related to parametric
inference for a single mean. I encourage you to attend the practice sessions and
review the examples in the Lock5 textbook for additional practice. For all your
answers be sure to "show your work" by printing the output of your calculations
in the R chunks.





$\\$




**Exercise 1.1 (5 points)**: Suppose you had a sampling distribution that was a 
t-distribution which had been created by taking samples of size n = 10. Please
find the two quantile values from this sampling distribution such that 5% of
your statistics are in each tail (and thus finding the end points where the
middle 90% of the t-statistics are between).

Hint: all quantile functions in R start with the letter *q*, and then have the
distribution name, so for quantiles of the t distribution we use the `qt()`
function and we specify the area we want and the degrees of freedom (df), i.e.,
`qt(area, df = degrees_of_freedom)`.



```{r q1_1, message=FALSE, warning=FALSE, tidy=TRUE}



```



**Answer**: 






$\\$   
 





**Exercise 1.2 (8 points)**: Find a 95% confidence interval for $\mu$ using 
the sample results $\bar{x}$ = 12.7, s = 5.6, and n = 30. Assume the underlying
distribution is relatively normal so using the t-distribution is valid here.

Hint: as usual, compute the t* quantile value, then compute the standard error
and then the confidence interval.


```{r q1_2, message=FALSE, warning=FALSE, tidy=TRUE}










```

**Answers**: 









$\\$





  
  

**Exercise 1.3 (8 points)**:  Please calculate the p-value that corresponds to
running a hypothesis test testing:  $H_0: \mu = 100$  vs. $H_A: \mu < 100$ based
on the sample results $\bar{x}$ = 91.7, s = 12.5, n = 30. Also, write down what 
you would conclude based on this p-value in the answer section below.

Hint: compute the t-statistic and the use `pt()` to find the appropriate
p-value. 


```{r q1_3, message=FALSE, warning=FALSE, tidy=TRUE}






```

**Answers**: 









$\\$  









**Exercise 1.4 (10 points)**: Children with autism often have a small head 
circumference at birth, followed by a sudden and excessive increase in head
circumference during the first year of life. A recent study examined the brain
tissue in autopsies of seven male children with autism between the ages of 2 and
16. The mean number of neurons in the pre-frontal cortex in male children
without autism of the same age is about 1.15 billion. The pre-frontal cortex is
the part of the brain most disrupted in autism, as it deals with language and
social communication. In the sample of seven children with autism, the mean
number of neurons in the pre-frontal cortex was 1.94 billion with a standard
deviation of 0.50 billion. The values in the sample are not heavily skewed. 

Please use the t-distribution to test whether this sample provides evidence that
male children with autism have more neurons (on average) in the pre-frontal
cortex than children without autism. (This study indicates that the causes of
autism may be present before birth.)

Please use the R chunk below to calculate a p-value that addresses this question
(and print out the relevant values to "show your work"). In the answer section,
write down the null and alternative hypotheses that you are testing using the
symbols we have used in class, and report  what you would conclude based on the
p-value you calculate.



```{r q1_4, message=FALSE, warning=FALSE, tidy=TRUE}






```



**Answers**: 











$\\$  





## Part 2: Parametric inference for two means


In the next set of exercises you will explore questions related to parametric
inference for comparing two means.



$\\$



**Exercise 2.1 (8 points)**:  Please use the R chunk below to calculate a p-value 
for testing the hypotheses:

 - $H_0: \mu_1 = \mu_2$
 - $H_A: \mu_1 > \mu_2$


based on the following data: 

Sample 1:  

 - $\bar{x}_1$ = 56
 - $s_1$ = 8.2
 - $n_1$ = 30   

Sample 2:  

 - $\bar{x}_2$ = 51
 - $s_2$ = 6.9
 - $n_2$ = 40  

In the answer section below, write down your conclusions in the answer section below.


```{r q2_1, message=FALSE, warning=FALSE, tidy=TRUE}






```


**Answers**: 







$\\$  






**Exercise 2.2 (9 points)**: Studies are finding that bacteria in the stomach 
are essential for healthy functioning of the human body. One study compared the
number of unique bacterial genes in stomachs of healthy patients and those of
patients with irritable bowel syndrome (IBS). For healthy patients, we have
$\bar{x}$ = 564 million with s = 122 million and n = 99. For those with IBS, we
have $\bar{x}$ = 425 million with s = 127 million and n = 25. Both distributions
appear to be approximately normally distributed. 

Please use the R chunk below to calculate the p-value for running a hypothesis
test to assess whether people with IBS have, on average, significantly fewer 
unique bacterial genes in their stomachs. In the answer section please write 
down the following information:
 
 * The null and alternative hypotheses in symbols
 * The value of the t-statistic
 * The p-value
 * What you would conclude based on the p-value you obtained. 
 
 
```{r q2_2, message=FALSE, warning=FALSE, tidy=TRUE}






```


**Answers**: 

* The null hypothesis is: 
* The alternative hypothesis is: 
* The t-statistic is: 
* The p-value is:  

Conclusion: 









$\\$  
 
 
 

 
 
 
## Part 3: Comparing different hypothesis tests

Many drivers of cars that can run on regular gas actually buy premium in the
belief that they will get better gas mileage. To test that belief, employees at
a food delivery company used 10 cars from a company fleet in which all the cars
run on regular gas. Each car was filled first with either regular or premium
gasoline, decided by a coin toss, and the miles per gallon (mpg) for that
tankful was recorded. Then the miles per gallon (mpg) was recorded again for the
same cars for a tankful of the other kind of gasoline. The drivers of these cars
did not know about this experiment.

The code below loads the data and extracts the two vectors that have the gas
mile per gallon for the 10 cars when they were driven using premium gas and
regular gas. You can assume that the 10 cars are listed in the same order for
both these vectors (i.e., the first value in the `premium` vector is the gas
miles per gallon for car 1 when it was driven using premium gas, and the first
value in the `regular` vector is the gas miles per gallon for car 1 when it was
driven using regular gas, etc.). You can also assume that the data in both
samples comes from distributions that are approximately normally distributed.

In the following exercises we will use several different types of tests to
examine whether premium gas provides better gas miles per gallon than regular gas. 


```{r q3, message=FALSE, warning=FALSE, tidy=TRUE}

# Load the data
gas <- read.table("gasoline.txt", header = TRUE)

# Extract the two samples for premium and regular gas mileage
premium <- gas$Premium
regular <- gas$Regular

```






$\\$





**Exercise 3.1 (13 points)**:  For the first exercise let's treat the two samples 
as independent. Start by stating the null and alternative hypotheses in symbols
and words. Then apply the following steps to conduct a two-sample t-test using
the R chunk below by filling in each step below the comment that describes
the step:

a. Visualze the data using a box plot. 

b. Compute the mean and the variance (i.e., the standard deviation squared) for
the miles per gallon using premium gas

c. Compute the mean and the variance (i.e., the standard deviation squared) for
the miles per gallon when using regular gas

d. Compute the standard error for two independent samples

e. Compute the t-statistic (and make sure that value is printed)

f. Compute the p-value (and make sure that value is printed)

g. Draw a conclusion with 


In the answer section, state what you conclude from running this hypothesis test,
using a significance level of $\alpha$ = 0.05.




$\\$




**State the null and alternative hypotheses**:  


In words:






In symbols:


 


```{r q3_1, message=FALSE, warning=FALSE, tidy=TRUE}
    
# a. visualize the data using a boxplot




# b. compute the mean and standard deviation (or variance) for the premium gas mpg



# c. compute the mean and standard deviation (or variance) for the regular gas mpg



# d. compute the standard error 



# e. compute the t-statistic



# f. compute the p-value


    
    
```

**Answer**: 







$\\$







**Exercise 3.2 (13 points)**: For the second exercise let's use a paired sample 
t-test to see if this would change our conclusion. To do this create a new
vector that has for each car, the miles per gallon that was recorded when premium
gas was used minus the miles per gallon when regular gas was used and call this
vector of differences `diff_means_vector`.  Let's call the mean of
this vector of differences $\bar{x_d}$.

Start by stating the null and alternative hypothesis in symbols and words and
then complete the following steps to run a hypothesis test:

a. Create a vector that has the difference of miles per gallon for premium vs.
regular gas. 

b. Plot these 10 differences as a strip chart using the 
`stripchart(diff_means_vector, method = "jitter")` function

c. Compute the standard error of the (paired) difference of mpg

d. Compute the t-statistic (and make sure that value is printed)

e. Compute the p-value (and make sure that value is printed)


In the answer section, state what you conclude from running this hypothesis test,
using a significance level of $\alpha$ = 0.05.  




$\\$




**State the null and alternative hypotheses here**: 


In words:





In symbols:








```{r q3_2, message=FALSE, warning=FALSE, tidy=TRUE}

# a. create a vector of the difference in premium and regular gas mpgs for each car



# b. plot the data using the stripchart() function: 



# c. compute the standard error of the difference of scores


# d. compute the t-statistic 



# e. compute the p-value




```

**Answer**: 







$\\$






**Exercise 3.3 (13 points)**: One other method we have used to test whether two 
means are different is simulation/randomization methods. Let's again treat the
two samples as if they were independent and run a simulation/randomization test
to assess whether premium gas provides better gas miles per gallon than regular gas.
To do this, follow the steps below in the R chunk provided:

a. Compute the observed statistic as the difference between means

b. Create a null distribution: i.e., combine the data, then repeat the following 
10,000 times: shuffle the combined data, separate into groups, calculate null statistic.

c. Plot the null distribution 

d. Compute the p-value


In the answer section, please do the following: 

1. State what you conclude from running this hypothesis test,
using a significance level of $\alpha$ = 0.05. 

2. Compare the p-value you obtained in this question to the p-value you 
obtained in parts 3.1 and 3.2, and discuss whether this is what you would expect.


```{r q3_3, message=FALSE, warning=FALSE, tidy=TRUE}

# a. Compute the observed statistic as a difference in means


# b. Create the null distribution





# c. Visualize the null distribution 




# d. Calculate the p-value




```



**Answer**: 

1.


2. 




$\\$




 

**Exercise 3.4 (8 points)**: R also has a built in function to run t-tests 
which is called `t.test()`. If we have two samples called `sample1` and
`sample2`, we can do a two independent sample t-test using: 
`t.test(sample1, sample2)`. The resulting p-value is for a two-tailed test. 
If we want the p-value for a right-tailed test we can set the argument to the
function alternative = "greater"  i.e., `t.test(sample1, sample2, alternative = "greater")`.
We can run a paired t-test by setting the argument to the function `paired = TRUE`.

Use R's `t.test()` function to calculate p-values on the gas miles per gallon
data using an independent sample t-test and a paired sample t-test. Compare the
results to the results you got using your own t-test. Do you notice any
differences? Describe what might be causing the difference in results in the
answer section below.

Hint: R's `t.test()` function is doing something slightly more sophisticated, so
look carefully at the output of running this function to see if any of the
values that R's `t.test()` function has computed differ from the values you
computed in the above exercises.



```{r q3_4, message=FALSE, warning=FALSE, tidy=TRUE}





```


**Answer**: 









$\\$   
 



 
## Part 4: Final project data and question (0 points)


Please state the question you will address in your final project and where you
will get the data from. Also, load the data into R in the chunk below to verify
that you can get the data into R.

Note: This question is listed as 0 points for this homework. However this same
question will be asked again and listed as worth 5 points on the next homework,
so please make sure you have a question and the relevant data ready by next
week!
 
 
```{r q4, message=FALSE, warning=FALSE, tidy=TRUE}





```




$\\$ 
 
 
 

## Reflection (3 points)


Please reflect on how the homework went by going to Canvas, going to the Quizzes
link, and clicking on Reflection on homework 9.
