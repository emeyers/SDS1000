---
title: "Practice Session 10 Answers"
format: pdf
editor: source
editor_options: 
  chunk_output_type: console
---


# *Part 1*


# **Chi-Square Test for Categorical Variables **


$\chi^2=\sum \frac{(\text { Observed }- \text { Expected })^2}{\text { Expected }}$


## Question 1 : Chi-Square ($\chi^2$) test- What Type of Ice Cream?

Sixty people were asked whether they preferred vanilla, chocolate, or strawberry ice cream and the
results are shown in the table below. Perform a chi-square goodness-of-fit test to determine whether the
flavors are equally popular.

$\\$

\begin{tabular}{|l|c|}
\hline Flavor & Frequency \\
\hline Vanilla & 28 \\
Chocolate & 23 \\
Strawberry & 9 \\
\hline TOTAL & 60 \\
\hline
\end{tabular}

$\\$


1.) Write the hypothesis of this Chi-Square test. Do the hypothesized proportions have the same values?



2.) Find the df ( degrees of freedom ).



3.) Calculate the Chi-Square test statistic using the formula. 



  a) Find the expected values for each category.



  b) Find the contribution of each category to the Chi-Square test statistic.



  c) Calculate now the Chi-Square test statistic.



4.) Find the p-value using `pchisq()` function. *hint*: find the function in help tab. 



5.) Make judgment about this test.


$\\$


**Answers**:


1.) The null hypothesis is that the flavors are equally likely to be preferred, while the alternative
hypothesis is that the flavors are not equally likely to be selected.

In symbols:

* $H_0: \pi_v=  \pi_c=  \pi_s= 1/3$ 


* $H_a$: Some  $\pi_i  \neq  1/3$


2.) Find the df ( degrees of freedom ).

There are three categories so we have $d f=2$. Using a chi-square distribution with $d f=2$.



3.) Calculate the Chi-Square test statistic using the formula. 


  a) Find the expected values for each category.


The expected counts:

$60 \times 1 / 3$ = 20 in each category.


  b) Find the contribution of each category to the Chi-Square test statistic.

Contribution to the chi-square statistic, $(O-E)^2 / E$, are shown as new columns in the table below.

$\\$

\begin{tabular}{|l|c|c|c|}
\hline Flavor & Observed & Expected & Contribution \\
\hline Vanilla & 28 & 20 & 3.2 \\
Chocolate & 23 & 20 & 0.45 \\
Strawberry & 9 & 20 & 6.05 \\
\hline TOTAL & 60 & 60 & 9.7 \\
\hline
\end{tabular}

$\\$

 
 
  c) Calculate now the Chi-Square test statistic.

We can see that the chi-square statistic is 9.7

$\chi^2-test-statisti =\sum \frac{(\text { observed }- \text { expected })^2}{\text { expected }}$



4.) Find the p-value using `pchisq()` function. *hint*: find the function in help tab. Calculate now the Chi-Square test statistic. 

We can see that the p-value is 0.0078 


```{r}
pchisq( 9.7, df= 2, lower.tail= F)

#0.007828
```



5.) Make judgment about this test.

The data provides strong evidence that the flavors are not equally preferred. (Note that the strongest
contributor to the chi-square statistic is the count for strawberry, which is below the expected count).


$\\$


### Question 2: Chi-Square ($\chi^2$) test- Genetic Variation

Studies in genetics often involve chi-square tests. For one gene, we expect $25 \%$ of people to have
the variant AA, $25 \%$ to have the variant BB , and $50 \%$ to have the variant AB . Observed counts of the three variants in one sample are shown. Do these counts provide evidence that the stated proportions are not right?


$\\$

\begin{tabular}{|c|c|}
\hline Variant & Frequency \\
\hline AA & 142 \\
BB & 121 \\
AB & 307 \\
\hline Total & 570 \\
\hline
\end{tabular}

$\\$


1.) Write the hypothesis of this Chi-Square test.


2.) Find the df ( degrees of freedom )


3.) Calculate the Chi-Square test statistic using the formula. 


  a) Find the expected values for each category.


  b) Find the contribution of each category to the Chi-Square test statistic.


  c) Calculate now the Chi-Square test statistic.


4.) Find the p-value using `pchisq()` function. *hint*: find the function in help tab. 


5.) Make judgment about this test.


**Answers**


1.) The null hypothesis is that the proportions of:

* $\pi_{A A}=0.25$

* $\pi_{B B}=0.25$ 

* $\pi_{A B}=0.50$ 

While the alternative hypothesis is at least one of the null proportions is not correct.


2.) There are three categories so we have $d f=2$. Using a chi-square distribution with $df=2$.


3.) 


  a) The expected counts are : 
 
 * For AA: 570 $\times 25 \%$ = 142.5
 
 * For BB: 570 $\times 25 \%$ = 142.5 
 
 * For AB : 570 $\times 50 \%$ = 285
 
 
  b) Find the contribution of each Category to the Chi^2 test statistic using $(O-E)^2 / E$
 
 $\\$
 
\begin{tabular}{|c|c|c|c|}
\hline Variant & Frequency & Observed & Contribution \\
\hline AA & 142 & 142.5 & 0.00 \\
BB & 121 & 142.5 & 3.24 \\
AB & 307 & 285 & 1.70 \\
\hline Total & 570 & & 4.94 \\
\hline
\end{tabular}

$\\$


  c) We see that the chi-square test statistic is 4.94 

 
 
4.) The  p -value is 0.0845 . 

```{r}
pchisq( 4.94, df= 2, lower.tail= F)

#0.08458486
```
 
 

5.) At a $5 \%$ level, we do not reject $H_0$. These data do not contradict the hypothesized proportions
for these three gene variants.



$\\$




#  *Part 2*

# **ANOVA to compare means**

## Question 3: ANOVA- Hanging out with friends

A survey given to a sample of high school seniors in Pennsylvania in the data `PASeniors`. Two of the variables in the survey are `HangHours`, the number of hours per week spent hanging out with friends, and `SchoolPressure`, the amount of pressure felt due to schoolwork (None, Very little, Some, or A lot). 

We wish to test whether the amount of school pressure felt by students is related to the mean time hanging out with friends. 


1.) Prepare the data and clean it using `na.omit(my_dataframe)`.


```{r}
library(SDS1000)
library(Lock5Data)
data(PASeniors)

cPASeniors<- na.omit(PASeniors)
```


2.) What is the explanatory variable? Is it categorical or quantitative? What is the response variable? Is it categorical or quantitative?
  
  

3.) Find the summary statistics for the groups of `SchoolPressure`, using function `mosaic::favstats( Response ~ grouping, data= )`. Which group has the largest mean and sd of the `HangHours` ?

```{r}
#your code here
```

4.) What is the hypothesis? 


5.) Use the function `aov(Response ~ grouping, data= )` to find the summary statistics for the ANOVA test.

Report the F-stat and the p-value.


```{r}
#your code here
```


6.) State the conclusion of the test in context.

$\\$


**Answers:**

1.) The explanatory variable is amount of pressure felt from schoolwork, which is categorical. The response variable is number of hours per week hanging out with friends, which is quantitative.



2). The highest mean ( 15.91 hours per week hanging with friends) is for the group feeling 'Very little' pressure from schoolwork. The lowest mean ( 9.866 hours per week hanging out with friends) is for the group feeling 'A lot' of pressure from schoolwork.



3.) Find the summary statistics for the groups of `SchoolPressure`, using function `mosaic::favstats( Response ~ grouping, data= )`. Which group has the largest mean and sd of the `HangHours` ?


```{r}

boxplot(HangHours ~ SchoolPressure, data= cPASeniors)

mosaic::favstats(HangHours ~ SchoolPressure, data= cPASeniors)

# create the ANOVA model
anova_model<- aov( HangHours ~ SchoolPressure, data= cPASeniors)

# summary statistics of the ANOVA model

summary(anova_model)
```



4.) $\begin{array}{ll}H_0: & \mu_1=\mu_2=\mu_3=\mu_4 \\ H_a: & \text { Some } \mu_i \neq \mu_j\end{array}$



5.) We see in the output that the F-statistic is 2.799 and the p-value is 0.04 .



6.) The p -value is small than 0.05, so we reject $H_{\mathrm{O}}$.
We have evidence of a difference in mean number of hours a week spent hanging out with friends depending on how much stress students feel from schoolwork.

$\\$



## Question 4: Running a randomization hypothesis test using an F-statistic for ANOVA- Hanging out with friends

Using the previous data `PASeniors`, and the two variables  `HangHours` and  `SchoolPressure`. Let test the previous hypothesis using the randomization distribution ( test whether the amount of school pressure felt by students is related to the mean time hanging out with friends. 


1.) Find the F-test-statistic using the function ` get_F_stat()`. Compare it to question 3.


2.) Create the null distribution and use `abline` to designate the F-stat. 


3.) Now calculate the p-values from the randomization and compare it to the previous p-value in Question 3.

4.) How many `k`  groups are in the `PASeniors`? What is the sample size N? Create the F distribution density curve using the function `df()`, and the **two degrees of freedom**: `df 1= k-1` and the `df 2= n-k`.

Plot this density curve on the same histogram of the randomization distribution.


**Answers:**


1.) Find the F-test-statistic using the function ` get_F_stat()`. Compare it to Question 3.


```{r}
F_stat <- get_F_stat(cPASeniors$HangHours, cPASeniors$SchoolPressure)
F_stat

```

The F-stat is 2.798 and it is the same as the previous F-stat found in Questions 3.



2.) Create the null distribution and use `abline` to designate the F-stat. 

```{r}
## create the null distribution 

 null_dist <- do_it(10000) * {
shuffled_SchoolPressure <- shuffle(cPASeniors$SchoolPressure)
get_F_stat(cPASeniors$HangHours, shuffled_SchoolPressure)
}

null_hist<- hist(null_dist, breaks = 200)
# visualize the null distribution 

hist(null_dist, breaks = 200)
abline(v = F_stat, col = "red")


```


3.) Now calculate the p-values from the randomization.


```{r}

p_value <- pnull(F_stat, null_dist, lower.tail = F) 
p_value

```
 
The p-value is 0.0439 which is the same as the p-value found in Question 3. (The answers may vary due to the randomization).
 
 
4.) How many `k`  groups are in the `PASeniors`? What is the sample size N? Create the F distribution density curve using the function `df()`, and the **two degrees of freedom** of the F-density are: `df 1= k-1` and the `df 2= n-k`.

Plot this density curve on the same histogram of the randomization distribution.

```{r}

# Plot the F-distribution

k<- 4          # number of groups
n<- 355        # sample size

df1<- k-1      # degrees of freedom of the "Between Variation"
df2<- n-k      # degrees of freedom of the "Within Variation"


# Density histogram 
hist(null_dist,
     breaks = 200,
     freq = FALSE,
     main = "Null Distribution with F(3,351) Density Curve",
     xlab = "F statistic",
     col = "lightblue")

# Overlay F-distribution density curve
curve(df(x, df1 = 3, df2 = 351),
      add = TRUE,
      col = "pink",
      lwd = 2)

abline(v = F_stat, col = "red2")

```

$\\$
